---
import supabase from '../utils/supabaseClient.js';
const { mode = 'login' } = Astro.props;
const isSignup = mode === 'signup';
---
<form id="auth-form" data-mode={isSignup ? 'signup' : 'login'}>
  <input type="email" name="email" placeholder="Email" required />
  <input type="password" name="password" placeholder="Password" required />
  <button type="submit">{isSignup ? 'Sign Up' : 'Log In'}</button>
</form>
<script type="module" client:load>
  import supabase from '../utils/supabaseClient.js';
  const form = document.getElementById('auth-form');
  const mode = form.dataset.mode;
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = form.email.value;
    const password = form.password.value;
    if (mode === 'signup') {
      await supabase.auth.signUp({ email, password });
    } else {
      await supabase.auth.signInWithPassword({ email, password });
    }
    window.location.href = '/members/dashboard';
  });
</script>
