:root{
  --bg:#0e0e0e;--ink:#eaeaea;--panel:#0b0b0bcc;
  --dist-stroke:#22d3ee;--dist-fill:#22d3ee55;
  --poi:#f59e0b;--gate:#ef4444;--park:#22c55e;--letter:#a78bfa;
  --roadA:#f8fafc;--roadS:#cbd5e1;--canal:#38bdf8;
}
html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);
  font:13.5px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Arial}
#wrap{height:100%;display:grid;grid-template-columns:minmax(0,1fr) 348px}
#mapPane{position:relative;overflow:hidden}
svg{width:100%;height:100%;display:block;touch-action:none}
/* layers */
.district{fill:var(--dist-fill);stroke:var(--dist-stroke);stroke-width:2;vector-effect:non-scaling-stroke}
.district:hover{stroke:#fff}
.road{fill:none;stroke-linecap:round;stroke-linejoin:round;vector-effect:non-scaling-stroke}
.road.avenue{stroke:var(--roadA)}
.road.street{stroke:var(--roadS)}
.road.canal{stroke:var(--canal)}
.river{fill:none;stroke:lightblue;stroke-width:7;stroke-linecap:round;stroke-linejoin:round;vector-effect:non-scaling-stroke}
.wall{fill:none;stroke:#94a3b8;stroke-width:8;vector-effect:non-scaling-stroke}
.pin{fill:var(--poi);stroke:#000;stroke-width:1.1}
.pin.gate{fill:var(--gate)} .pin.park{fill:var(--park)} .pin.letter{fill:var(--letter)}
.lbl{font:700 10px ui-monospace,SFMono-Regular,Consolas;text-anchor:middle;fill:#0b0b0b}
.selected{filter:drop-shadow(0 0 6px #fff9)}
/* edit handles */
.handle{fill:#fff;stroke:#111;stroke-width:1.1;cursor:grab}
.handle:active{cursor:grabbing}
.ghost{stroke-dasharray:6 4;opacity:.8}
/* tooltip */
#tip{position:absolute;pointer-events:none;z-index:9;min-width:220px;max-width:min(360px,44vw);
  background:rgba(0,0,0,.78);backdrop-filter:blur(6px);border:1px solid #333;border-radius:12px;
  padding:10px 12px;transform:translate(10px,10px);box-shadow:0 8px 22px #000a}
#tip h3{margin:.1rem 0 .3rem;font-size:14px}
#tip p{margin:.25rem 0;font-size:12px;opacity:.95}
/* side panel */
#side{background:var(--panel);border-left:1px solid #222;padding:12px;overflow:auto}
#side h2{margin:.2rem 0 .6rem;font-size:16px}
fieldset{border:1px solid #2a2a2a;border-radius:10px;padding:8px;margin:.5rem 0}
legend{opacity:.85;font-weight:700}
.row{display:flex;gap:8px;align-items:center;margin:.25rem 0;flex-wrap:wrap}
label{display:flex;align-items:center;gap:.35rem}
input[type="text"], select, input[type="number"]{
  background:#0f0f0f;border:1px solid #333;border-radius:8px;color:#e5e7eb;padding:6px 8px;font:12px system-ui
}
button{background:#121212;border:1px solid #333;border-radius:10px;color:#eaeaea;padding:8px 10px;font:600 12px system-ui;cursor:pointer}
button.primary{border-color:#4f46e5}
#json{width:100%;min-height:160px;background:#0f0f0f;border:1px solid #222;color:#cbd5e1;border-radius:10px;padding:8px;font:12px ui-monospace,SFMono-Regular,Consolas}
#quickPanel{position:absolute;left:12px;bottom:12px;display:flex;gap:10px;align-items:center;
  background:#0b0b0bcc;border:1px solid #222;border-radius:12px;padding:8px 10px;backdrop-filter:blur(6px)}
#quickPanel .key{display:flex;gap:10px;align-items:center;flex-wrap:wrap;font:12px system-ui;opacity:.9}
#quickPanel .dot{display:inline-block;width:10px;height:10px;border-radius:50%;border:1px solid #0003;margin-right:6px;vertical-align:-1px}
#quickPanel .dot.gate{background:var(--gate)} .dot.park{background:var(--park)} .dot.letter{background:var(--letter)} .dot.poi{background:var(--poi)}
#poiModal{position:absolute;left:12px;bottom:64px;min-width:300px;background:#0b0b0fdd;border:1px solid #222;border-radius:12px;
  padding:10px 12px;box-shadow:0 8px 22px #000a;backdrop-filter:blur(6px)}
#poiModal .hdr{font-weight:700;margin-bottom:.35rem}
/* cursor feedback by mode */
body[data-mode="draw-district"] svg,
body[data-mode="draw-road"] svg{cursor:crosshair}
@media (max-width:980px){#wrap{grid-template-columns:1fr}}
.grass{fill:none;stroke:#16a34a;stroke-opacity:.4;stroke-linecap:round;stroke-linejoin:round;vector-effect:non-scaling-stroke}
.forest{fill:none;stroke:#166534;stroke-opacity:.75;stroke-linecap:round;stroke-linejoin:round;vector-effect:non-scaling-stroke}
.mountain{fill:none;stroke:#78350f;stroke-opacity:.8;stroke-linecap:round;stroke-linejoin:round;vector-effect:non-scaling-stroke}